# Результаты экспериментов

## Сводная таблица моделей (DVC-пайплайн)

Результаты запуска `dvc repro` - сравнение трёх алгоритмов:

| Модель | Train RMSE | Val RMSE | Val MAE | Val R² | Статус |
|---|---|---|---|---|---|
| Linear Regression | 4.627 | 4.826 | 3.211 | 0.672 | - |
| Ridge (α=1.0) | 4.627 | 4.825 | 3.202 | 0.673 | - |
| **Random Forest** | **1.651** | **3.776** | **2.499** | **0.799** | ✅ Best |

**Лучшая модель:** Random Forest (выбор по минимальному `val_rmse`)

---

## Результаты на тестовой выборке

Оценка лучшей модели (Random Forest) на отложенной тестовой выборке:

| Метрика | Значение | Интерпретация |
|---|---|---|
| **RMSE** | 3.449 тыс. $ | Среднеквадратичная ошибка |
| **MAE** | 2.269 тыс. $ | Средняя абсолютная ошибка |
| **R²** | 0.838 | Объяснено ~84% дисперсии |

---

## Анализ переобучения

Сравнение train vs val RMSE показывает степень переобучения:

| Модель | Train RMSE | Val RMSE | Gap | Переобучение |
|---|---|---|---|---|
| Linear Regression | 4.627 | 4.826 | 0.199 | Минимальное |
| Ridge (α=1.0) | 4.627 | 4.825 | 0.198 | Минимальное |
| Random Forest | 1.651 | 3.776 | 2.125 | Умеренное |

!!! info "Вывод"
    Linear Regression и Ridge почти не переобучаются (маленький gap),
    но их качество хуже. Random Forest переобучается умеренно, но даёт
    наилучшее качество на валидации и тесте.

---

## Расширенный набор экспериментов (HW3, 21 прогон)

В рамках HW3 запущен расширенный набор экспериментов через `scripts/run_experiments.py`
с сеткой гиперпараметров:

### Linear Regression
- Без гиперпараметров (1 вариант)

### Ridge
- `alpha`: 0.01, 0.1, 1.0, 10.0, 100.0 (5 вариантов)

### Random Forest
- `n_estimators`: 50, 100, 200
- `max_depth`: 5, 10, None
- Итого: 9 вариантов (3×3)

### Lasso (опционально)
- `alpha`: 0.01, 0.1, 1.0, 10.0, 100.0 (5 вариантов)

**Итого: 21 эксперимент, залогированных в MLflow.**

Результаты доступны в MLflow UI:

```bash
poetry run mlflow ui --backend-store-uri sqlite:///mlflow.db --port 5000
# http://localhost:5000
```

---

## Визуализации

Для генерации графиков запустите:

```bash
poetry run python scripts/generate_report.py
```

Создаются файлы в `reports/figures/hw6/`:

- `model_comparison.png` - сравнение моделей по всем метрикам
- `train_val_gap.png` - train vs val RMSE (анализ переобучения)
- `test_metrics.png` - итоговые метрики на тесте

---

## Параметры моделей

### Linear Regression
```yaml
kind: linear_regression
params: {}  # нет гиперпараметров
```

### Ridge
```yaml
kind: ridge
params:
  alpha: 1.0
```

### Random Forest
```yaml
kind: random_forest
params:
  n_estimators: 100
  max_depth: 10
```

---

## Конфигурация данных

| Параметр | Значение |
|---|---|
| Датасет | Boston Housing (506 примеров) |
| Test size | 20% (102 примера) |
| Val size | 20% от train (81 пример) |
| Train | ~323 примера |
| Random state | 42 |
| Нормализация | StandardScaler |
